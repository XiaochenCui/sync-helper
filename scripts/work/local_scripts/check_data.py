d1 = '232302fe4c455754454231343148463136363837330101d512070a0b0c390101030101180001e758150d26f43b011e023d0065020101024d521e4cf463150426f6050006afb11001ea58e00601730ce401020cd0010147010246070000000000000000000901010030474646474746464747464647474646474746464747464647474646474746464747464647474646474746464747464647080101150d26f400a40001a40cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0c'

d3 = '232302fe4c455754454231343148463136363837330101d512070a0f171d01010301017c0001eb7c148c299b12012e02101500020101014f537755f060146a2998050006afaaf001ea29ba06010f0c9401620c76010149010248070000000000000000000901010030494848494948484949484849494848494948484949484849494848494948484949484849494848494948484949484849080101148c299b00a40001a40c8a0c800c8a0c800c8a0c800c8a0c8a0c8a0c8a0c8a0c8a0c8a0c8a0c940c8a0c940c8a0c940c8a0c940c8a0c940c8a0c940c8a0c8a0c800c8a0c800c8a0c800c8a0c800c8a0c800c8a0c8a0c8a0c8a0c8a0c8a0c8a0c8a0c8a0c'

d4 = '232302fe4c455754454231343148463136363837330101c712070b102e000102010100000001f2481576240e35010001d90000050006afb08801ea2c180601010d1601010d160101530102520700000000000000000009010100305352525353525253535252535352525353525253535252535352525353525253535252535352525353525253535252530801011576240e00a40001a40d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d'

d5 = '232302fe4c455754454231343148463136363837330101c712070b102e000102010100000001f2481576240e35010001d90000050006afb08801ea2c180601010d1601010d160101530102520700000000000000000009010100305352525353525253535252535352525353525253535252535352525353525253535252535352525353525253535252530801011576240e00a40001a40d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d160d01'

d6 = '232302fe4c4450353142393638484331373133383001030212070d0f320201010301000000006c160eb627395f01000bb70000020101044d4e204e164f0f0a2706050006afb11801ea2e00060116100901430ff8011efe010944070000000000000000000801010eb62739005c00015c1001100110061005100110001004100710010ffc0fff10020ffe0fff10051003100010010ffe0fff100010091005100510000fff10001001100110001001100210011001100210040fff0fff10001000100210051000100510001000100210020ffd0ffd0ff90ffc0ffa0ffc0ffe0ffd0ffa0fff0fff0ffc0ffe0ffc10000fff0ffc0ffb0ff80fff0ffc0ffb10010ffe0ffd10010fff0ffd0fff0ffe0ffd0fff0ffc0ffc10000fff0ffe0ffe0ffb0ffd0ffc0ffd0ffc0fff09010100244545454545454545444545454545454545454545454545454545454545fefefefefefefe8201a9584c453137000000830000177000000000000000a00000000000000000000000a30000000000000000000001237d00000001108c000000013180007ff800830d080000013320904605ff4d4f10000001350001200001011005000001390000000d006900000000013f00401e300000694000000144000000000000000000000153ef00c800000000080000015a19461946328c328c000002110200000000f200000000022a0000000000000000000002347019108c004ebb000000023500020000000000000000024a33160816180000000000026e0bb70bb713b10100000003100ff8100a0fff0eb70000032000000eb6444545000000033d272521c4c58ffffe00000341ff400000001000000000035a8000508b00000000000003f1000000000acf00000000041d0028000000000000000004210000000000000000000004310000000400003600000004830000360000000000000005210103010000000000000005250116100a01330ff8000005310000000000000000000005410106450109440000000005af0001005c00240000000005ee016b6c636c656172000005f0010104000000000083001a0001005d0004584c4531372d322e303054302d453343000000006e'

error_length_data_1 = '232303fe4c45575445423134364a4e31303032313701019d12070d0e151301010301000000001372157a27274901000794000002010104504e204e2056156627100500073a0ff801dc1eda0601020eec01010eba010b4a010648070000000000000000000901010020494949494948494949494a4a4a4a494949494949494949494949494949494949080101157a272700900001900eba0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0ed80eec0eec0eec0ee20eec0eec0eec0eec0eec0ee20eec0eec0eec0eba0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0ee20eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0eec0ece0eec0eec0eec0ee20eec0eec0eec0eec0eec0eec0eec09'

error_length_data_2 = '232302fe4c45575743413332374a4e303830303937010292120710090a11010103010000000000000d4027104a010013880000020101044b4e204e204c0d402710050006af9e9001ea34ec06015a0d0101230cfb010547010146070000000000000000000801010d40271000660001660cfe0cfe0cfe0cfe0cff0cfe0cff0cff0cff0cff0cfe0cfc0cfe0cfe0cfe0cfe0cfe0cfe0cfe0cfe0cfe0cfe0cfe0cfd0cfd0cfd0cfe0cfd0cfd0cfe0cfe0cfe0cfe0cff0cfb0cfd0cfd0cfd0cfd0cfd0cfd0cfe0cfe0cfe0cfe0cfe0cfe0cfc0cfd0cfd0cfe0cfc0cfd0cfd0cfd0cfd0cff0cfc0cfd0cfe0cff0cff0d000cfe0cff0d000cff0cfd0cfc0cfd0cfe0cfe0cfe0cfe0cfe0cfe0cfe0d000cfe0cfc0cfe0cff0d000cff0cff0d000d000cff0d000d010cff0cfc0cfe0cfe0cfe0cff0d000cff0d000cff0cff0d000901010018464646464747464646464647464647474747474647474747820131584c4e4a410c64d3d001003075000000a50c66d5d001000000000000521078d0d30c0000000000001d1079d0d3400d10278887641d107ad0d3327d30750000001d1082d0d510000000000000b41083d0d5400d310d102700b41084d0d5ee07a4066a043a021085d0d51c01c894881303b41086d0d582188382050166001087d0d5010dfb0c5a23fd0c1c68dbd0400d1027210000bf1c69dbd000000000000000f91c6adbd000b89488878200f91c6bddd000000000000000bf1c6cded0002d0000000000001c6dded025110000450000001c6eded002303937000000001cf102d00f040800e6026e011cf103d089000000000049001cf302d584848813102700001cf401db00000000000000001801d0df89001500030000671889ded5004b41427101c00c188aded512051e0a141e110083001a000100000004584c4e4a412d312e30392d45334300000000000061'

error_length_data_3 = '232302fe4c455754454231343148463136363837330101d5120710090a1501010301033e0002024c14c82a9c43012e020d0a00020101015c59af52088914b82a9a050006b1795001eb1c8a0601010cb201020ca801014b0102490700000000000000000009010100304b49494b4b49494b4b49494b4b49494b4b49494b4b49494b4b49494b4b49494b4b49494b4b49494b4b49494b4b49494b08010114c82a9c00a40001a40cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80cb20ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80ca80c'

platform_login_data_1 = '232305fe4c474842325631393046433230303030310100291207120a0b07000170666c6f67696e5f63776a6870666c6f67696e5f63776a6800000000000000000189'

reissue_data_1 = '23230302455654584c454d31333138373230303032010006120718111a1443'

data_1 = '232302fe4c455754454231345848453130333934310101d512071e0b252801010301000000028f261544273855010002750000020101044f4e204e2055153a2710050006e880d801b57d740601010cf801010cf80101490102480700000000000000000009010100304948484949484849494848494948484949484849494848494948484949484849494848494948484949484849494848490801011544273800a40001a40cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf80cf8c4'

data_2 = '232302fe4c455754454231343248453130333934380101d512071e0d1d0a0101030100000000844c150b274640011001c3006502010104504e204e2058150b2710050006ccba08015804c00601010cda01020cd001014a01014a0700000000000000000009010100304a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a4a080101150b274600a40001a40cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd00cda0cd0cb'

data_3 = '232302fe4c455754454231343748453130333931340101d512071e0a09390101030100e60000acf2152d27565a010e01ed00000201010152515e4ee85d1528272e050006cc96c8015d911a0601010cee012c0cda01014a0102480700000000000000000009010100304a48484a4a48484a4a48484a4a48484a4a48484a4a48484a4a48484a4a48484a4a48484a4a48484a4a48484a4a48484a080101152d275600a40001a40cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40cda0ce40cda0ce40cda0ce40cda0ce40cda0cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40cee0ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40ce40cee0ce40cee0ce40cee0ce40cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0ceee7'

data_4 = '232303fe4c455754454231343948463136373232320101d51206151007180101030102620001c5e514e028e725012e02020800020101014e568c51405814e028e5050006e8b31001b5bf480601230cda01020ca801014701024607000000000000000000090101003047464647474646474746464747464647474646474746464747464647474646474746464747464647474646474746464708010114e028e700a40001a40cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cda0cbc0cda0cbc0cda0cc60cda0cc60cda0cc60cda0cc60cda0cc60cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cd00cbc0cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60cb20cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cc60ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca80cbc0ca8de'

data_5 = '232303fe4c455754454231343748463136373138350101d51206180a0e2301010001014a000187e4153826a65b011e021c0065020101024f52cb4b645a153826a8050006e8a1d801b3f7580601010cf801520cda010147010245070000000000000000000901010030474545474745454747454547474545474745454747454547474545474745454747454547474545474745454747454547080101153826a600a40001a40cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0ce40cda0ce40cda0ce40cda0ce40cda0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80cee0cf80ceee7'

merged_data_1 = '232303024c4557544542313434484531303338393901000612061b16043515232303024c4557544542313437484531303337343901000612061b16051d3d232303024c4557544542313432484531303338393801000612061b16050523232303024c4557544542313432484531303338393801000612061b16052305'

merged_data_2 = '232303014c4557544542313430484531303339373801000612071815160f35232303014c4557544542313437484531303339343501000612071815152818232303014c455754454231343448453130333939370100061207181515102c232303014c4557544542313438484531303338373301000612071815150a31232303014c455754454231345848453130333934310100061207181515267d232303014c4557544542313434484531303338333701000612071815160e3a232303014c4557544542313436484531303339323201000612071815161625232303014c4557544542313458484531303339343101000612071815170851232303014c4557544542313430484531303339373801000612071815170f34232303014c4557544542313430484531303337363801000612071815152610232303014c45575445423134344845313033383337010006120718150f2c01232303014c4557544542313433484531303338373601000612071815180931232303014c4557544542313430484531303337363801000612071815172612232303014c45575445423134354845313033393133010006120718150e2e04232303014c45575445423134344845313033393937010006120718150f2e08232303014c45575445423134364845313034303034010006120718150f3313232303014c4557544542313434484531303339343901000612071815100c36232303014c4557544542313430484531303339373801000612071815102d11232303014c4557544542313437484531303339353901000612071815101e26232303014c4557544542313458484531303339313001000612071815100f55232303014c4557544542313431484531303339303801000612071815100d37232303014c4557544542313458484531303339313001000612071815120f57232303014c4557544542313439484631363732323201000612071815103a0a232303014c4557544542313438484531303339343001000612071815102c13232303014c4557544542313438484531303339343001000612071815122c11232303014c455754454231343348453130333934330100061207181510182f232303014c4557544542313433484531303337383101000612071815120633232303014c4557544542313432484531303339353101000612071815142f1e232303014c4557544542313430484531303339373801000612071815142d15232303014c4557544542313432484531303339353101000612071815151222232303014c4557544542313436484531303338343101000612071815132113232303014c4557544542313430484531303338393701000612071815102b17232303014c4557544542313432484531303339353101000612071815143001232303014c4557544542313431484531303339303801000612071815110d36232303014c4557544542313432484531303339353101000612071815151f2f232303014c4557544542313431484531303339323501000612071815160033232303014c4557544542313432484531303339343801000612071815151f27232303014c4557544542313430484531303338393701000612071815112b16232303014c4557544542313432484531303339353101000612071815152212232303014c4557544542313436484531303338343101000612071815170335232303014c4557544542313437484531303339313401000612071815162116232303014c45575445423134304845313033373638010006120718150e260b232303014c45575445423134364845313034303034010006120718150d3311232303014c4557544542313458484531303339333801000612071815121143232303014c4557544542313437484531303339313401000612071815170335232303014c45575445423134384845313033383733010006120718150e2808232303014c45575445423134364845313034303034010006120718150e1534232303'

data = '232302fe4c45575743413332374a4e34303131393701022a1302140e3b1a0101030100460000023a0ca327580dfe2efffe1b0002010101fefffefffefefffefffe050006d0ed10015a202a0601520c6a01110c5e01087a01063e07000000001000000000080101fffefffe00800001800c640c640c620c670c660c660c670c640c640c630c620c670c610c640c680c620c5e0c5f0c5f0c640c620c630c640c5f0c5e0c630c630c630c5f0c600c630c5f0c680c680c600c630c600c620c620c610c620c610c620c680c640c690c660c620c640c640c640c640c620c620c630c620c610c630c640c650c620c620c610c600c620c620c630c600c640c640c620c630c670c660c620c680c630c630c640c690c630c6a0c610c620c630c620c670c650c650c660c690c640c630c620c640c620c620c680c650c650c650c64fffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffefffe09010100183f3f3f3f3f3e3e7a3f3f3f3f3f3e3e3e3e3f3f3f3f3f4040820095584c4a41321c68dbd0a30c5827690700c21c69dbd080020000004b00b91c6adbd000061b90887a00b91c6bddd007000000000000ba1c6cded02e2d0000100000001c6dded025110000150000001c6eded002313937000000001cf102d00f04241b360632031cf103d086000000000041001cf401db3f023900000000001889ded5004b41427101c00c188aded512051e0a141e110083001a000100700004584c4a41322d312e30302d45334300000000000069'

data = '232301fe4c45575743413332374a4e3430313139370100361302140e183900013839383630333137343732303638363036333334011830324b504246373533323633374138415030303031323431ba'


from utils.package_utils.validate import (
    ValidateError,
    validate_package,
)
from new_energy_obd.forward.deconstruct_package import deconstruct_package
from utils.time_utils import unix_timestamp
import datetime


datas = [
    # d1,
    # d3,
    # d4,
    # d5,
    # d6,
    # error_length_data_1,
    # error_length_data_2,
    # error_length_data_3,
    # platform_login_data_1,
    # reissue_data_1,
    # data_1,
    # data_2,
    # data_3,
    # data_4,
    # data_5,
    data,
]

merged_datas = [
    # merged_data_1,
    # merged_data_2,
]


def validate(datas):
    for d in datas:
        d = d.decode('hex')
        try:
            package = deconstruct_package(d)
        except Exception:
            print 'Package length not validata: {}'.format(len(d))
            continue
        print 'Payload length: {}'.format(package.length)
        print 'Payload actual length: {}'.format(len(package.payload))
        print 'Vin: {}'.format(package.unique_code)
        dt = package.payload[:6]
        timestamp = unix_timestamp(dt)
        print 'Timestamp: {}'.format(timestamp)
        print 'Datetime: {}'.format(datetime.datetime.fromtimestamp(int(timestamp)))
        try:
            validate_package(package)
        except ValidateError as e:
            print e


if __name__ == '__main__':
    validate(datas)
    for merged_data in merged_datas:
        merged_data = merged_data.decode('hex')
        datas = []
        tmp_datas = merged_data.split('##')
        for d in tmp_datas:
            datas.append(d)
        validate(datas)
